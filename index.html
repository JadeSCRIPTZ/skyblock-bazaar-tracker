<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Arachne Crystal Calculator | Hypixel SkyBlock</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg:#0f1115; --card:#171a21; --text:#e6e6e6;
      --muted:#9aa0aa; --accent:#ff8c2a; --border:#262a33;
    }
    *{box-sizing:border-box}
    body{
      margin:0;font-family:Inter,sans-serif;
      background:linear-gradient(180deg,#0f1115,#0b0d12);
      color:var(--text);min-height:100vh;
      display:flex;align-items:center;justify-content:center;
    }
    .container{max-width:900px;width:100%;padding:24px}
    .card{
      background:var(--card);border:1px solid var(--border);
      border-radius:18px;padding:28px;
      box-shadow:0 10px 30px rgba(0,0,0,.4)
    }
    h1{margin:0 0 6px;font-size:30px}
    .subtitle{color:var(--muted);margin-bottom:16px}
    .tabs{display:flex;gap:12px;margin-bottom:20px}
    .tab{flex:1;padding:12px;border-radius:12px;
      background:#0f1218;border:1px solid var(--border);
      color:var(--text);font-weight:600;cursor:pointer}
    .tab.active{background:var(--accent);color:#111}
    .input-group{display:flex;gap:12px;margin-bottom:24px}
    input{
      flex:1;padding:14px;border-radius:12px;
      border:1px solid var(--border);
      background:#0f1218;color:var(--text)
    }
    button{
      padding:14px 22px;border-radius:12px;
      border:none;background:var(--accent);
      color:#111;font-weight:700;cursor:pointer
    }
    table{width:100%;border-collapse:collapse;margin-top:20px}
    th,td{padding:14px;border-bottom:1px solid var(--border)}
    th{color:var(--muted);font-size:14px}
    .total{
      margin-top:20px;padding:16px;border-radius:14px;
      background:#0f1218;border:1px solid var(--border);
      display:flex;justify-content:space-between;font-weight:700
    }
    .accent{color:var(--accent)}
  </style>
</head>
<body>

<div class="container">
  <div class="card">
    <h1>Arachne Crystal Calculator</h1>
    <div class="subtitle">Hypixel SkyBlock â€¢ Select price source</div>

    <div class="tabs">
      <div class="tab active" id="manualTab" onclick="setMode('manual')">Manual Prices</div>
      <div class="tab" id="liveTab" onclick="setMode('live')">Live (skyblock.finance)</div>
    </div>

    <div class="input-group">
      <input id="amount" type="number" min="1" placeholder="How many crystals? (ex: 10)">
      <button onclick="calculate()">Calculate</button>
    </div>

    <table id="table" style="display:none">
      <thead>
        <tr>
          <th>Item</th>
          <th>Total Amount</th>
          <th>Price (each)</th>
          <th>Total Cost</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>

    <div class="total" id="grandTotal" style="display:none"></div>
  </div>
</div>

<script>
const PROXY = 'https://api.allorigins.win/raw?url=';
let MODE = 'manual';

function setMode(mode){
  MODE = mode;
  manualTab.classList.toggle('active', mode==='manual');
  liveTab.classList.toggle('active', mode==='live');
}

const ITEMS = [
  {name:'Arachne Fragment', per:3, manual:83329, url:'https://skyblock.finance/items/ARACHNE_FRAGMENT'},
  {name:'Spider Eye', per:8, manual:9399, url:'https://skyblock.finance/items/SPIDER_EYE'},
  {name:'String', per:30, manual:35892, url:'https://skyblock.finance/items/STRING'}
];

async function getPrice(item){
  if(MODE==='manual') return item.manual;
  try{
    const r = await fetch(PROXY+encodeURIComponent(item.url));
    const t = await r.text();
    const m = t.match(/Sell Price<[^>]*>\\s*<[^>]*>([0-9,]+)/i);
    return m ? parseInt(m[1].replace(/,/g,'')) : item.manual;
  }catch{ return item.manual }
}

async function calculate(){
  const amt = +amount.value;
  if(!amt) return;

  tbody.innerHTML='';
  let total=0;

  for(const i of ITEMS){
    const price = await getPrice(i);
    const qty = i.per * amt;
    const cost = price * qty;
    total += cost;

    tbody.innerHTML += `
      <tr>
        <td>${i.name}</td>
        <td>${qty.toLocaleString()}</td>
        <td>${price.toLocaleString()} coins</td>
        <td>${cost.toLocaleString()} coins</td>
      </tr>`;
  }

  table.style.display='table';
  grandTotal.style.display='flex';
  grandTotal.innerHTML = `
    <span>Total for <span class="accent">${amt}</span> crystals</span>
    <span class="accent">${total.toLocaleString()} coins</span>`;
}
</script>

</body>
</html>
